@model QUANLYTHUVIEN.Models.Rental
@{
    ViewData["Title"] = "Thanh toán lại";
    var rental = ViewBag.Rental as QUANLYTHUVIEN.Models.Rental;
}

<!-- Start: Page Banner -->
<section class="page-banner services-banner">
    <div class="container">
        <div class="banner-header">
            <h2>Thanh toán lại đơn hàng</h2>
            <span class="underline center"></span>
            <p class="lead">Thanh toán lại cho đơn hàng #@rental.RentalId</p>
        </div>
        <div class="breadcrumb">
            <ul>
                <li><a href="@Url.Action("Index", "Home")">Trang chủ</a></li>
                <li><a href="@Url.Action("MyRentals", "Rental")">Sách đang thuê</a></li>
                <li>Thanh toán lại</li>
            </ul>
        </div>
    </div>
</section>
<!-- End: Page Banner -->

<!-- Start: Payment Section -->
<div id="content" class="site-content">
    <div id="primary" class="content-area">
        <main id="main" class="site-main">
            <div class="books-media-gird">
                <div class="container" style="padding: 60px 15px;">
                    <div class="row">
                        <div class="col-md-8 offset-md-2">
                            <div class="payment-card" style="background: #fff; border: 1px solid #dee2e6; border-radius: 8px; padding: 30px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                <h3 style="margin-bottom: 25px; color: #333;">
                                    <i class="fa fa-credit-card"></i> Thanh toán lại đơn hàng #@rental.RentalId
                                </h3>

                                <!-- Rental Info -->
                                <div class="rental-info" style="background: #f8f9fa; padding: 20px; border-radius: 6px; margin-bottom: 25px;">
                                    <h5 style="margin-bottom: 15px; color: #555;">Thông tin đơn hàng</h5>
                                    <table class="table table-borderless" style="margin: 0;">
                                        <tr>
                                            <td style="width: 40%; padding: 8px 0;"><strong>Mã đơn:</strong></td>
                                            <td style="padding: 8px 0;">#@rental.RentalId</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 8px 0;"><strong>Ngày đặt:</strong></td>
                                            <td style="padding: 8px 0;">@rental.RentalDate?.ToString("dd/MM/yyyy HH:mm")</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 8px 0;"><strong>Số lượng sách:</strong></td>
                                            <td style="padding: 8px 0;">@rental.RentalDetails.Sum(rd => rd.Quantity ?? 0) cuốn</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 8px 0;"><strong>Tổng tiền:</strong></td>
                                            <td style="padding: 8px 0;">
                                                <strong style="color: #e74c3c; font-size: 20px;">
                                                    @(rental.TotalAmount?.ToString("N0") ?? "0") đ
                                                </strong>
                                            </td>
                                        </tr>
                                    </table>
                                </div>

                                <!-- Payment Methods -->
                                <form method="post" asp-action="Repay" asp-controller="Rental" asp-route-id="@rental.RentalId">
                                    @Html.AntiForgeryToken()
                                    
                                    <h5 style="margin-bottom: 15px; color: #555;">Chọn phương thức thanh toán</h5>
                                    
                                    <div class="payment-methods" style="margin-bottom: 25px;">
                                        <div class="form-check" style="padding: 15px; border: 2px solid #dee2e6; border-radius: 6px; margin-bottom: 15px; cursor: pointer; transition: all 0.3s;">
                                            <input class="form-check-input" type="radio" name="paymentMethod" id="vnpay" value="vnpay" checked style="margin-top: 8px;">
                                            <label class="form-check-label" for="vnpay" style="cursor: pointer; width: 100%;">
                                                <div style="display: flex; align-items: center;">
                                                    <i class="fa fa-credit-card" style="font-size: 24px; color: #0066cc; margin-right: 15px;"></i>
                                                    <div>
                                                        <strong style="font-size: 16px;">Cổng thanh toán VNPay</strong>
                                                        <p style="margin: 5px 0 0 0; color: #666; font-size: 14px;">Thanh toán trực tuyến qua VNPay</p>
                                                    </div>
                                                </div>
                                            </label>
                                        </div>

                                        <div class="form-check" style="padding: 15px; border: 2px solid #dee2e6; border-radius: 6px; margin-bottom: 15px; cursor: pointer; transition: all 0.3s;">
                                            <input class="form-check-input" type="radio" name="paymentMethod" id="cash" value="cash" style="margin-top: 8px;">
                                            <label class="form-check-label" for="cash" style="cursor: pointer; width: 100%;">
                                                <div style="display: flex; align-items: center;">
                                                    <i class="fa fa-money" style="font-size: 24px; color: #28a745; margin-right: 15px;"></i>
                                                    <div>
                                                        <strong style="font-size: 16px;">Thanh toán tiền mặt</strong>
                                                        <p style="margin: 5px 0 0 0; color: #666; font-size: 14px;">Thanh toán khi nhận sách tại thư viện</p>
                                                    </div>
                                                </div>
                                            </label>
                                        </div>

                                        <div class="form-check" style="padding: 15px; border: 2px solid #dee2e6; border-radius: 6px; cursor: pointer; transition: all 0.3s;">
                                            <input class="form-check-input" type="radio" name="paymentMethod" id="bank" value="bank" style="margin-top: 8px;">
                                            <label class="form-check-label" for="bank" style="cursor: pointer; width: 100%;">
                                                <div style="display: flex; align-items: center;">
                                                    <i class="fa fa-university" style="font-size: 24px; color: #17a2b8; margin-right: 15px;"></i>
                                                    <div>
                                                        <strong style="font-size: 16px;">Chuyển khoản ngân hàng</strong>
                                                        <p style="margin: 5px 0 0 0; color: #666; font-size: 14px;">Chuyển khoản qua ngân hàng</p>
                                                    </div>
                                                </div>
                                            </label>
                                        </div>
                                    </div>

                                    <!-- Actions -->
                                    <div class="payment-actions" style="border-top: 1px solid #e9ecef; padding-top: 20px;">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <a href="@Url.Action("Details", "Rental", new { id = rental.RentalId })" class="btn btn-secondary btn-lg" style="width: 100%;">
                                                    <i class="fa fa-arrow-left"></i> Quay lại
                                                </a>
                                            </div>
                                            <div class="col-md-6">
                                                <button type="submit" class="btn btn-primary btn-lg" style="width: 100%;">
                                                    <i class="fa fa-check"></i> Xác nhận thanh toán
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
<!-- End: Payment Section -->

@section Scripts {
    <script>
        // Highlight selected payment method
        $('.form-check-input').on('change', function() {
            $('.form-check').css('border-color', '#dee2e6');
            $(this).closest('.form-check').css('border-color', '#007bff');
        });
        
        // Set initial highlight
        $('.form-check-input:checked').closest('.form-check').css('border-color', '#007bff');
    </script>
}



